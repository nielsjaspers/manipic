<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SVG to PNG - Manipic</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400..700;1,400..700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../styles.css">
</head>
<body>
    <div class="tool-container">
        <a href="../index.html" class="back-btn">‚Üê Back</a>
        <h1 class="lora-unique">SVG to PNG</h1>
        <div class="upload-area" id="uploadArea">
            <svg width="50" height="50" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                <polyline points="7,10 12,15 17,10"/>
                <line x1="12" y1="15" x2="12" y2="3"/>
            </svg>
            <p>Click to upload SVG or paste from clipboard</p>
            <input id="fileInput" type="file" accept=".svg" style="display:none" />
        </div>
        <canvas id="canvas" style="display:none;"></canvas>
        <div class="customization" id="customization">
            <label>Width:</label>
            <input type="number" id="width" value="512">
            <label>Height:</label>
            <input type="number" id="height" value="512">
        </div>
        <button id="downloadBtn" style="display:none;">Download</button>
    </div>
    <script src="../script.js"></script>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        let svgString = null;
        let originalFilename = 'image.svg';

        bindPersistentFileInput(
            document.getElementById('uploadArea'),
            document.getElementById('fileInput'),
            (file) => loadSVG(file)
        );

        handleClipboardPaste((pastedImg) => {
            // For SVG, clipboard might not work directly, but try
            if (pastedImg) {
                // Assume it's an image, but for SVG, better to handle text
            }
        });

        function loadSVG(file) {
            originalFilename = file.name;
            const reader = new FileReader();
            reader.onload = (e) => {
                svgString = e.target.result;
                drawSVG();
            };
            reader.readAsText(file);
        }

        function drawSVG() {
            if (!svgString) return;
            document.getElementById('uploadArea').style.display = 'none';
            document.getElementById('canvas').style.display = 'block';
            document.getElementById('customization').classList.add('show');
            document.getElementById('downloadBtn').style.display = 'block';
            const width = parseInt(document.getElementById('width').value);
            const height = parseInt(document.getElementById('height').value);
            canvas.width = width;
            canvas.height = height;
            const img = new Image();
            const svgDataUrl = 'data:image/svg+xml;base64,' + btoa(svgString);
            img.onload = () => {
                ctx.drawImage(img, 0, 0, width, height);
            };
            img.src = svgDataUrl;
        }

        document.getElementById('width').addEventListener('input', drawSVG);
        document.getElementById('height').addEventListener('input', drawSVG);

        document.getElementById('downloadBtn').addEventListener('click', () => {
            downloadCanvas(canvas, originalFilename, 'svg2png');
        });
    </script>
</body>
</html>